{"version":3,"sources":["app/decorators/action.ts"],"names":[],"mappings":";AAAA,0CAA0C;;AAE1C,+DAA+E;AAE/E,oDAAiD;AAOjD;;;;;;GAMG;AACH,gBAAuB,SAAiB,KAAK,EAAE,OAAe,EAAE;IAC/D,MAAM,CAAC,UAAU,KAAU,EAAE,QAAgB;QAC5C,EAAE,CAAC,CAAC,OAAO,CAAC,WAAW,CAAC,mBAAQ,CAAC,MAAM,EAAE,KAAK,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC;YACvE,MAAM,IAAI,wCAAiB,CAAC,4BAA4B,CAAC,CAAC;QAC3D,CAAC;QAED,EAAE,CAAC,CAAC,IAAI,IAAI,IAAI,CAAC,CAAC,CAAC;YAClB,IAAI,GAAG,EAAE,CAAC;QACX,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,IAAI,GAAG,CAAC,CAAC,CAAC;YACxB,IAAI,GAAG,QAAQ,CAAC;QACjB,CAAC;QAAC,IAAI,CAAC,CAAC;YACP,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBAC/C,oBAAoB;gBACpB,IAAI,GAAG,GAAG,GAAG,IAAI,CAAC;YACnB,CAAC;YACD,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBACxB,wBAAwB;gBACxB,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YACxC,CAAC;QACF,CAAC;QAED,OAAO,CAAC,cAAc,CAAC,mBAAQ,CAAC,MAAM,EAAE,CAAC,MAAM,EAAE,IAAI,CAAC,EAAE,KAAK,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;QAErF,MAAM,CAAC,KAAK,CAAC;IACd,CAAC,CAAC;AAEH,CAAC;AA1BD,wBA0BC","file":"action.js","sourcesContent":["/// <reference types=\"reflect-metadata\" />\r\n\r\nimport { IDependencyContainer, CriticalException } from 'back-lib-common-util';\r\n\r\nimport { MetaData } from '../constants/MetaData';\r\nimport { serverContext } from '../ServerContext';\r\n\r\n\r\nexport type HttpVerbs = 'GET' | 'POST';\r\nexport type ActionDecorator = (method?: string, path?: string) => Function;\r\n\r\n/**\r\n * Used to decorate action function of REST controller class.\r\n * @param {string} method Case-insensitive HTTP verb such as GET, POST, DELETE...\r\n * @param {string} path Segment of URL pointing to this controller.\r\n * \t\tIf '_' is given, uses target function name as path.\r\n * \t\tIf not specified, it is default to be empty tring.\r\n */\r\nexport function action(method: string = 'GET', path: string = ''): Function {\r\n\treturn function (proto: any, funcName: string): Function {\r\n\t\tif (Reflect.hasMetadata(MetaData.ACTION, proto.constructor, funcName)) {\r\n\t\t\tthrow new CriticalException('Duplicate action decorator');\r\n\t\t}\r\n\r\n\t\tif (path == null) {\r\n\t\t\tpath = '';\r\n\t\t} else if (path == '_') {\r\n\t\t\tpath = funcName;\r\n\t\t} else {\r\n\t\t\tif (path.length >= 1 && !path.startsWith('/')) {\r\n\t\t\t\t// Add heading slash\r\n\t\t\t\tpath = '/' + path;\r\n\t\t\t}\r\n\t\t\tif (path.endsWith('/')) {\r\n\t\t\t\t// Remove trailing slash\r\n\t\t\t\tpath = path.substr(0, path.length - 1);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tReflect.defineMetadata(MetaData.ACTION, [method, path], proto.constructor, funcName);\r\n\r\n\t\treturn proto;\r\n\t};\r\n\r\n}"]}