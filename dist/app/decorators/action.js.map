{"version":3,"sources":["app/decorators/action.ts"],"names":[],"mappings":";AAAA,0CAA0C;;AAE1C,+DAA+E;AAE/E,oDAAiD;AAOjD;;;;;GAKG;AACH,gBAAuB,SAAiB,KAAK,EAAE,IAAa;IAC3D,MAAM,CAAC,UAAU,KAAU,EAAE,QAAgB;QAC5C,EAAE,CAAC,CAAC,OAAO,CAAC,cAAc,CAAC,mBAAQ,CAAC,MAAM,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;YAC9D,MAAM,IAAI,wCAAiB,CAAC,4BAA4B,CAAC,CAAC;QAC3D,CAAC;QAED,EAAE,CAAC,CAAC,IAAI,IAAI,IAAI,CAAC,CAAC,CAAC;YAClB,IAAI,GAAG,EAAE,CAAC;QACX,CAAC;QAAC,IAAI,CAAC,CAAC;YACP,EAAE,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBAC1B,uBAAuB;gBACvB,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YAC1B,CAAC;YACD,EAAE,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBACxB,wBAAwB;gBACxB,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YACxC,CAAC;QACF,CAAC;QACD,IAAI,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;QAE1B,OAAO,CAAC,cAAc,CAAC,mBAAQ,CAAC,MAAM,EAAE,CAAC,MAAM,EAAE,IAAI,CAAC,EAAE,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC;QAEzE,MAAM,CAAC,KAAK,CAAC;IACd,CAAC,CAAC;AAEH,CAAC;AAzBD,wBAyBC","file":"action.js","sourcesContent":["/// <reference types=\"reflect-metadata\" />\r\n\r\nimport { IDependencyContainer, CriticalException } from 'back-lib-common-util';\r\n\r\nimport { MetaData } from '../constants/MetaData';\r\nimport { serverContext } from '../ServerContext';\r\n\r\n\r\nexport type HttpVerbs = 'GET' | 'POST';\r\nexport type ActionDecorator = (method?: string, path?: string) => Function;\r\n\r\n/**\r\n * Used to decorate action function of REST controller class.\r\n * @param {string} method Case-insensitive HTTP verb such as GET, POST, DELETE...\r\n * @param {string} path Segment of URL pointing to this controller.\r\n * \t\tIf not specified, it is default to be empty tring.\r\n */\r\nexport function action(method: string = 'GET', path?: string): Function {\r\n\treturn function (proto: any, funcName: string): Function {\r\n\t\tif (Reflect.hasOwnMetadata(MetaData.ACTION, proto[funcName])) {\r\n\t\t\tthrow new CriticalException('Duplicate action decorator');\r\n\t\t}\r\n\r\n\t\tif (path == null) {\r\n\t\t\tpath = '';\r\n\t\t} else {\r\n\t\t\tif (path.startsWith('/')) {\r\n\t\t\t\t// Remove heading slash\r\n\t\t\t\tpath = path.substring(1);\r\n\t\t\t}\r\n\t\t\tif (path.endsWith('/')) {\r\n\t\t\t\t// Remove trailing slash\r\n\t\t\t\tpath = path.substr(0, path.length - 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tpath = path.toLowerCase();\r\n\r\n\t\tReflect.defineMetadata(MetaData.ACTION, [method, path], proto[funcName]);\r\n\r\n\t\treturn proto;\r\n\t};\r\n\r\n}"]}